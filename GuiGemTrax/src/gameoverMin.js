var savedScore; gameOver = { init: function () { game.log(), savedScore = ("        " + score).slice(-8) }, create: function () { this.add.image(0, 0, "background"); for (var e = [], t = 0; t < game.global.tileTypes; t++)e.push(t); var a = game.add.emitter(160, -30, 50); a.makeParticles("tiles", e), a.maxParticleScale = 1, a.minParticleScale = .7, a.setYSpeed(30, 40), a.setXSpeed(-3, 3), a.gravity = 0, a.width = 320, a.minRotation = 0, a.maxRotation = 40, a.flow(15e3, 2e3); var o = 0; try { o = localStorage.getItem("GuiGemTrax_BestScore") } catch (e) { console.log(e), o = 0 } var r = 0; r = Number(o), console.log("output " + r), console.log("oldScore " + r), console.log("savedScore" + savedScore), r < savedScore && (localStorage.setItem("GuiGemTrax_BestScore", savedScore), newhighscoreText = game.add.bitmapText(170, 235, "systemfont", "New High Score! ", 24), newhighscoreText.x = (game.width - newhighscoreText.textWidth) / 2), highscoreTextM = game.add.bitmapText(40, 270, "systemfont", "Best: ", 36), highscoreText = game.add.bitmapText(155, 270, "scorefont", o, 36), highscoreText.align = "center", highscoreText.x = (game.width - highscoreText.textWidth) / 2 + 20, o < savedScore && (highscoreText.bitmapText = 36), scoreText = game.add.bitmapText(160, 180, "scorefont", savedScore, 48), scoreText.align = "center", scoreText.x = (game.width - scoreText.textWidth) / 2 - 20, game.add.image(160, 70, "gameover").anchor.setTo(.5), game.add.button(160, 360, "playbutton", this.playTheGame, this).anchor.setTo(.5).clicked = !1 }, playTheGame: function (e) { if (!e.cliked) { e.cliked = !0, game.global.playerLevel = 1; var t = game.add.sprite(0, 0, "blackfade"); t.alpha = 0; var a = game.add.tween(t); a.to({ alpha: 1 }, 500, Phaser.Easing.Cubic.Out, !0), a.onComplete.add(function () { game.state.start("TheGame") }, this) } } };